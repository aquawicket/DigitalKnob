# https://www.cryptopp.com/
# https://github.com/weidai11/cryptopp
#
# https://github.com/weidai11/cryptopp/archive/refs/tags/CRYPTOPP_8_5_0.zip

if(IOSSIM)
	#DKDEPEND(libmd)
	#DKDEPEND(macports)
endif()

### VERSION ###
DKSET(CRYPTO_VERSION 8_5_0)
DKSET(CRYPTO_DL https://github.com/weidai11/cryptopp/archive/refs/tags/CRYPTOPP_8_5_0.zip)



### INSTALL ###
DKSET(CRYPTO_NAME CRYPTOPP_${CRYPTO_VERSION})
DKSET(CRYPTO ${3RDPARTY}/${CRYPTO_NAME})
DKINSTALL(${CRYPTO_DL} cryptopp ${CRYPTO})


### LINK ###
WIN_DEBUG_DKLIB(${CRYPTO}/${OS}/${DEBUG_DIR}/cryptopp-static.lib)
WIN_RELEASE_DKLIB(${CRYPTO}/${OS}/${RELEASE_DIR}/cryptopp-static.lib)
APPLE_DEBUG_DKLIB(${CRYPTO}/${OS}/cryptopp.build/Debug/cryptopp-object.build/libcryptopp-object.a)
APPLE_RELEASE_DKLIB(${CRYPTO}/${OS}/cryptopp.build/Release/cryptopp-object.build/libcryptopp-object.a)
LINUX_DEBUG_DKLIB(${CRYPTO}/${OS}/${DEBUG_DIR}/libcryptopp.a)
LINUX_RELEASE_DKLIB(${CRYPTO}/${OS}/${RELEASE_DIR}/libcryptopp.a)
RASPBERRY_DEBUG_DKLIB(${CRYPTO}/${OS}/${DEBUG_DIR}/libcryptopp.a)
RASPBERRY_RELEASE_DKLIB(${CRYPTO}/${OS}/${RELEASE_DIR}/libcryptopp.a)
ANDROID_DEBUG_DKLIB(${CRYPTO}/${OS}/${DEBUG_DIR}/libcryptopp.a)
ANDROID_RELEASE_DKLIB(${CRYPTO}/${OS}/${RELEASE_DIR}/libcryptopp.a)


### COMPILE ###
DKSETPATH(${CRYPTO}/${BUILD_DIR})

WIN_DKQCOMMAND(${DKCMAKE_BUILD} -DBUILD_STATIC=ON -DBUILD_SHARED=OFF -DBUILD_TESTING=OFF ${CRYPTO})
WIN_VS(${CRYPTO_NAME} cryptopp.sln cryptopp-static)


if(MAC)
	string(REPLACE "-DMAC " " " DKCMAKE_MAC64_CRYPTOPP "${DKCMAKE_BUILD}") #fix of class named MAC in cryptopp
endif()
MAC_DKQCOMMAND(${DKCMAKE_MAC64_CRYPTOPP} -DBUILD_STATIC=ON -DBUILD_SHARED=OFF -DBUILD_TESTING=OFF -DCRYPTOPP_DISABLE_MIXED_ASM=ON ${CRYPTO})
MAC_XCODE(${CRYPTO_NAME} cryptopp-static)


IOS_DKQCOMMAND(${DKCMAKE_BUILD} -DBUILD_STATIC=ON -DBUILD_SHARED=OFF -DBUILD_TESTING=OFF ${CRYPTO})
IOS_XCODE(${CRYPTO_NAME} cryptopp-static)


IOSSIM_DKQCOMMAND(${DKCMAKE_BUILD} -DBUILD_STATIC=ON -DBUILD_SHARED=OFF -DBUILD_TESTING=OFF ${LIBMD_CMAKE} ${CRYPTO})
IOSSIM_XCODE(${CRYPTO_NAME} cryptopp-static)


LINUX_DKQCOMMAND(${DKCMAKE_BUILD} -DBUILD_STATIC=ON -DBUILD_SHARED=OFF -DBUILD_TESTING=OFF ${CRYPTO})
LINUX_DKQCOMMAND(make cryptopp-static)


RASPBERRY_DKQCOMMAND(${DKCMAKE_BUILD} -DBUILD_STATIC=ON -DBUILD_SHARED=OFF -DBUILD_TESTING=OFF ${CRYPTO})
RASPBERRY_DKQCOMMAND(make cryptopp-static)


if(ANDROID)
	string(REPLACE "-DANDROID_CPP_FEATURES=\"rtti exceptions\";" "" DKCMAKE_BUILD "${DKCMAKE_BUILD}")
endif(ANDROID)
ANDROID_DKQCOMMAND(${DKCMAKE_BUILD} "-DCMAKE_CXX_FLAGS=/I${ANDROIDNDK}/sources/android/cpufeatures" -DBUILD_STATIC=ON -DBUILD_SHARED=OFF -DBUILD_TESTING=OFF ${CRYPTO})
ANDROID_VS(${CRYPTO_NAME} cryptopp.sln cryptopp-static)
