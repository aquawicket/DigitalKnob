# https://github.com/DanBloomberg/leptonica
# README: https://tinsuke.wordpress.com/2011/02/17/how-to-cross-compiling-libraries-for-ios-armv6armv7i386/

# http://www.leptonica.org
#
# https://github.com/DanBloomberg/leptonica/archive/refs/tags/1.82.0.zip
# http://www.leptonica.org/source/leptonica-1.74.4.tar.gz

### DEPENDS ###
dk_depend(zlib)
dk_depend(tiff)
dk_depend(libpng)
IF(ANDROID)
	dk_depend(jpeg)
ELSE()
	dk_depend(libjpeg-turbo)
ENDIF()
dk_depend(giflib)


dk_import(https://github.com/DanBloomberg/leptonica)
#dk_set(LEPTONICA_MAJOR 1)
#dk_set(LEPTONICA_MINOR 82)
#dk_set(LEPTONICA_BUILD 0)
#dk_set(LEPTONICA_VERSION ${LEPTONICA_MAJOR}.${LEPTONICA_MINOR}.${LEPTONICA_BUILD})
#dk_set(LEPTONICA_NAME leptonica-${LEPTONICA_VERSION})
#dk_set(LEPTONICA_DL https://github.com/DanBloomberg/leptonica/archive/refs/tags/${LEPTONICA_VERSION}.zip)
#dk_set(LEPTONICA ${3RDPARTY}/${LEPTONICA_NAME})
#dk_install(${LEPTONICA_DL} leptonica ${LEPTONICA})


### LINK ###
dk_include(${LEPTONICA})
dk_include(${LEPTONICA}/${OS}/src)
dk_include(${LEPTONICA}/${OS}/${RELEASE_DIR}/src)
WIN_DEBUG_DKLIB(${LEPTONICA}/${OS}/src/${DEBUG_DIR}/${LEPTONICA_NAME}d.lib)
WIN_RELEASE_DKLIB(${LEPTONICA}/${OS}/src/${RELEASE_DIR}/${LEPTONICA_NAME}.lib)
APPLE_DEBUG_DKLIB(${LEPTONICA}/${OS}/src/${DEBUG_DIR}/libleptonica.a)
APPLE_RELEASE_DKLIB(${LEPTONICA}/${OS}/src/${RELEASE_DIR}/libleptonica.a)
LINUX_DEBUG_DKLIB(${LEPTONICA}/${OS}/${DEBUG_DIR}/src/libleptonica.a)
LINUX_RELEASE_DKLIB(${LEPTONICA}/${OS}/${RELEASE_DIR}/src/libleptonica.a)
ANDROID_DEBUG_DKLIB(${LEPTONICA}/${OS}/${DEBUG_DIR}/obj/local/armeabi-v7a/libleptonica.a)
ANDROID_RELEASE_DKLIB(${LEPTONICA}/${OS}/${RELEASE_DIR}/obj/local/armeabi-v7a/libleptonica.a)


### 3rdParty Link ###
WIN_dk_set(LEPTONICA_CMAKE -DLeptonica_DIR=${LEPTONICA}/${OS})


### COMPILE ###
dk_setPath(${LEPTONICA}/${BUILD_DIR})

WIN_DKQCOMMAND(${DKCMAKE_BUILD} -DSTATIC=ON -DCMAKE_INSTALL_PREFIX=${LEPTONICA} ${ZLIB_CMAKE} ${TIFF_CMAKE} ${PNG_CMAKE} ${JPEG_CMAKE} ${GIF_CMAKE} ${LEPTONICA})
WIN_VS(${LEPTONICA_NAME} LEPTONICA.sln leptonica)

MAC_DKQCOMMAND(${DKCMAKE_BUILD} -DSTATIC=ON -DCMAKE_INSTALL_PREFIX=${LEPTONICA} ${ZLIB_CMAKE} ${TIFF_CMAKE} ${PNG_CMAKE} ${JPEG_CMAKE} ${GIF_CMAKE} ${LEPTONICA})
MAC_XCODE(${LEPTONICA_NAME} leptonica)


IOS_DKQCOMMAND(${DKCMAKE_BUILD} -DSTATIC=ON -DCMAKE_INSTALL_PREFIX=${LEPTONICA} ${ZLIB_CMAKE} ${TIFF_CMAKE} ${PNG_CMAKE} ${JPEG_CMAKE} ${GIF_CMAKE} ${LEPTONICA})
IOS_XCODE(${LEPTONICA_NAME} leptonica)


IOSSIM_DKQCOMMAND(${DKCMAKE_BUILD} -DSTATIC=ON -DCMAKE_INSTALL_PREFIX=${LEPTONICA} ${SDL2_CMAKE} ${TIFF_CMAKE} ${PNG_CMAKE} ${JPEG_CMAKE} ${GIF_CMAKE} ${LEPTONICA})
IOSSIM_XCODE(${LEPTONICA_NAME} leptonica)


LINUX_DKQCOMMAND(${DKCMAKE_BUILD} -DSTATIC=ON -DCMAKE_INSTALL_PREFIX=${LEPTONICA} ${ZLIB_CMAKE} ${TIFF_CMAKE} ${PNG_CMAKE} ${JPEG_CMAKE} ${GIF_CMAKE} ${LEPTONICA})
LINUX_DKQCOMMAND(make leptonica)


RASPBERRY_DKQCOMMAND(${DKCMAKE_BUILD} -DSTATIC=ON -DCMAKE_INSTALL_PREFIX=${LEPTONICA} ${ZLIB_CMAKE} ${TIFF_CMAKE} ${PNG_CMAKE} ${JPEG_CMAKE} ${GIF_CMAKE} ${LEPTONICA})
RASPBERRY_DKQCOMMAND(make leptonica)


ANDROID_DKQCOMMAND(${DKCMAKE_BUILD} -DSTATIC=ON -DCMAKE_INSTALL_PREFIX=${LEPTONICA} ${ZLIB_CMAKE} ${TIFF_CMAKE} ${PNG_CMAKE} ${JPEG_CMAKE} ${GIF_CMAKE} ${LEPTONICA})
ANDROID_VS(${LEPTONICA_NAME} LEPTONICA.sln leptonica)
