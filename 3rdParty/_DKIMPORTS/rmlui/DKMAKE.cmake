# https://github.com/mikke89/RmlUi
# https://github.com/aquawicket/RmlUi


### DEPENDS ###
DKDEPEND(freetype)
#DKDEPEND(glew)
#DKDEPEND(sdl)
#DKDEPEND(sdl_image)
#DKDEPEND(sfml)



### VERSION ###
#DKSET(RMLUI_DL https://github.com/mikke89/RmlUi/archive/34a77f7034882a04252ca5a531354c144d92a806.zip)
#DKSET(RMLUI_DL https://github.com/aquawicket/RmlUi/archive/9216572b79563159cc28af8fa56d051f58630449.zip)
DKSET(RMLUI_DL https://github.com/aquawicket/RmlUi/archive/8ee72bdcd683afefbb66467fcddc20539ab67297.zip)
DKSET(RMLUI_VERSION aquawicket)
DKSET(RMLUI_NAME RmlUi-${RMLUI_VERSION})
DKSET(RMLUI ${3RDPARTY}/${RMLUI_NAME})
DKINSTALL(${RMLUI_DL} rmlui ${RMLUI} PATCH)



### LINK ###
DKDEFINE(RMLUI_STATIC_LIB)
ANDROID_DKDEFINE(CHOBO_FLAT_MAP_NO_THROW)
ANDROID_DKDEFINE(RMLUI_USE_CUSTOM_RTTI)
IF(IOS OR IOSSIM OR WIN)
	#DKDEFINE(RMLUI_NO_THIRDPARTY_CONTAINERS)
ENDIF()
DKINCLUDE(${RMLUI}/Include)
DKINCLUDE(${RMLUI}/Source)
dk_addTarget(rmlui RmlCore)
dk_addTarget(rmlui RmlDebugger)

if(rmlui_RmlCore)
	WIN_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/RmlCore.lib)
	WIN_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/RmlCore.lib)
	MAC_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/libRmlCore.a)
	MAC_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/libRmlCore.a)
	IOS_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/libRmlCore.a)
	IOS_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/libRmlCore.a)
	IOSSIM_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/libRmlCore.a)
	IOSSIM_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/libRmlCore.a)
	LINUX_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/libRmlCore.a)
	LINUX_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/libRmlCore.a)
	RASPBERRY_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/libRmlCore.a)
	RASPBERRY_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/libRmlCore.a)
	ANDROID_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/libRmlCore.a)
	ANDROID_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/libRmlCore.a)
endif()

if(rmlui_RmlDebugger)
	DKDEFINE(HAVE_rmlui_debugger)
	WIN_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/RmlDebugger.lib)
	WIN_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/RmlDebugger.lib)
	WIN_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/RmlDebugger.lib)
	MAC_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/libRmlDebugger.a)
	MAC_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/libRmlDebugger.a)
	IOS_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/libRmlDebugger.a)
	IOS_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/libRmlDebugger.a)
	IOSSIM_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/libRmlDebugger.a)
	IOSSIM_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/libRmlDebugger.a)
	LINUX_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/libRmlDebugger.a)
	LINUX_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/libRmlDebugger.a)
	RASPBERRY_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/libRmlDebugger.a)
	RASPBERRY_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/libRmlDebugger.a)
	ANDROID_DEBUG_DKLIB(${RMLUI}/${OS}/${DEBUG_DIR}/libRmlDebugger.a)
	ANDROID_RELEASE_DKLIB(${RMLUI}/${OS}/${RELEASE_DIR}/libRmlDebugger.a)
endif()




#### RML minimal #####
DKSETPATH(${RMLUI}/${BUILD_DIR})

#### RML + ALL Extras #####
#WIN_DKSETPATH(${RMLUI}/${OS})
#WIN32_DKQCOMMAND(${DKCMAKE_BUILD} 
#"-DCMAKE_CXX_FLAGS=/DWIN32 /D_WINDOWS /W3 /nologo /GR /EHsc -DRMLUI_STATIC_LIB -DGLEW_STATIC /I${RMLUI}/Include /I${SDL}/include /I${GLEW}/include" 
#-DBUILD_SAMPLES=ON -DBUILD_TESTING=ON -DENABLE_SVG_PLUGIN=OFF -DENABLE_LOTTIE_PLUGIN=OFF -DBUILD_LUA_BINDINGS=OFF ${FREETYPE_CMAKE} ${SDL2IMAGE_CMAKE} ${GLEW_CMAKE} ${SDL2_CMAKE} ${SFML_CMAKE} 
#${RMLUI})

WIN_DKQCOMMAND(${DKCMAKE_BUILD} "-DCMAKE_CXX_FLAGS=/DRMLUI_STATIC_LIB /DGLEW_STATIC /I${RMLUI}/Include /I${SDL}/include /I${GLEW}/include" -DBUILD_SHARED_LIBS=OFF -DBUILD_SAMPLES=OFF -DBUILD_TESTING=OFF -DENABLE_SVG_PLUGIN=OFF -DENABLE_LOTTIE_PLUGIN=OFF -DBUILD_LUA_BINDINGS=OFF ${FREETYPE_CMAKE} ${RMLUI})
if(rmlui_RmlCore)
	WIN_VS(${RMLUI_NAME} RmlUi.sln RmlCore)
endif()
if(rmlui_RmlDebugger)
	WIN_VS(${RMLUI_NAME} RmlUi.sln RmlDebugger)
endif()

##WIN32_DKQCOMMAND(${CMAKE_EXE} -G "Visual Studio 16 2019" -A Win32 "-DCMAKE_CXX_FLAGS=/DWIN32 /D_WINDOWS /W3 /nologo /GR /EHsc -DRMLUI_STATIC_LIB /I${3RDPARTY}/${RMLUI_NAME}/Include /I${SDL}/include /I${GLEW}/include" "-DCMAKE_CXX_FLAGS_DEBUG=/MTd /Od /Ob0 /Zi /RTC1 /DDEBUG /D_DEBUG" "-DCMAKE_CXX_FLAGS_RELEASE=/MT /O2 /Ob2 /DNDEBUG" -DBUILD_SHARED_LIBS=OFF -DBUILD_SAMPLES=ON ${FREETYPE_CMAKE} ${SDL2_CMAKE} -DSDL2_IMAGE_LIBRARY_TEMP=${SDLIMAGE}/${OS}/lib/${RELEASE_DIR}/SDL_image.lib -DSDL2_IMAGE_INCLUDE_DIR=${SDLIMAGE} -DGLEW_DIR=${GLEW}/build/cmake -DGLEW_INCLUDE_DIR=${GLEW} -DGLEW_SHARED_LIBRARY_DEBUG=${GLEW}/${OS}/lib/${DEBUG_DIR}/libglew32d.lib -DGLEW_SHARED_LIBRARY_RELEASE=${GLEW}/${OS}/lib/${RELEASE_DIR}/libglew32.lib -DGLEW_STATIC_LIBRARY_DEBUG=${GLEW}/${OS}/lib/${DEBUG_DIR}/glew32d.lib -DGLEW_STATIC_LIBRARY_RELEASE=${GLEW}/${OS}/lib/${RELEASE_DIR}/glew32.lib -DCMAKE_PREFIX_PATH=${GLEW} -DSFML_INCLUDE_DIR=${SFML}/include -DSFML_MAIN_LIBRARY_DEBUG=${SFML}/${OS}/lib/${DEBUG_DIR}/sfml-main-d.lib -DSFML_MAIN_LIBRARY_RELEASE=${SFML}/${OS}/lib/${RELEASE_DIR}/sfml-main.lib -DSFML_SYSTEM_LIBRARY_DEBUG=${SFML}/${OS}/lib/${DEBUG_DIR}/sfml-system-s-d.lib -DSFML_SYSTEM_LIBRARY_RELEASE=${SFML}/${OS}/lib/${DEBUG_DIR}/sfml-system-s.lib -DSFML_WINDOW_LIBRARY_DEBUG=${SFML}/${OS}/lib/${DEBUG_DIR}/sfml-window-s-d.lib -DSFML_WINDOW_LIBRARY_RELEASE=${SFML}/${OS}/lib/${RELEASE_DIR}/sfml-window-s.lib -DSFML_GRAPHICS_LIBRARY_DEBUG=${SFML}/${OS}/lib/${DEBUG_DIR}/sfml-graphics-s-d.lib -DSFML_GRAPHICS_LIBRARY_RELEASE=${SFML}/${OS}/lib/${RELEASE_DIR}/sfml-graphics-s.lib ${RMLUI})

### COMPILE ###
#WIN_DKSETPATH(${RMLUI}/${OS})
#WIN32_DKQCOMMAND(${CMAKE_EXE} -G ${GENERATOR} -A Win32 "-DCMAKE_CXX_FLAGS=/DWIN32 /D_WINDOWS /W3 /nologo /GR /EHsc /I${RMLUI}/Include /I${SDL}/include" "-DCMAKE_CXX_FLAGS_DEBUG=/MTd /Od /Ob0 /Zi /RTC1 /DDEBUG /D_DEBUG" "-DCMAKE_CXX_FLAGS_RELEASE=/MT /O2 /Ob2 /DNDEBUG" -DBUILD_SHARED_LIBS=OFF -DBUILD_SAMPLES=ON -DFREETYPE_INCLUDE_DIR_freetype2=${FREETYPE}/include -DFREETYPE_INCLUDE_DIR_ft2build=${FREETYPE}/include -DFREETYPE_LIBRARY=${FREETYPE}/${OS}/${RELEASE_DIR}/freetype.lib -DFREETYPE_LIBRARY_DEBUG=${FREETYPE}/${OS}/${DEBUG_DIR}/freetype.lib -DFREETYPE_LIBRARY_RELEASE=${FREETYPE}/${OS}/${RELEASE_DIR}/freetype.lib -DSDL2_INCLUDE_DIR=${SDL} -DSDL2_LIBRARY=${SDL}/${OS}/${RELEASE_DIR}/SDL2.lib -DSDL2_LIBRARY_TEMP=${SDL}/${OS}/${RELEASE_DIR}/SDL2.lib -DSDL2_IMAGE_INCLUDE_DIR=${SDLIMAGE} -DSDL2_IMAGE_LIBRARY_TEMP=${SDLIMAGE}/${OS}/lib/${RELEASE_DIR}/SDL_image.lib -DGLEW_INCLUDE_DIR=${GLEW} -DGLEW_STATIC_LIBRARY_DEBUG=${GLEW}/${OS}/lib/${DEBUG_DIR}/glew32d.lib -DGLEW_STATIC_LIBRARY_RELEASE=${GLEW}/${OS}/lib/${RELEASE_DIR}/glew32.lib ${RMLUI})
#WIN_VS(${RMLUI_NAME} RmlUi.sln)

## Test Building with Msys/Mingw
##WIN32_DKQCOMMAND(${CMAKE_EXE} -G "MSYS Makefiles" -DCMAKE_MAKE_PROGRAM=${MSYS}/bin/make.exe -DENABLE_PRECOMPILED_HEADERS=OFF -DDISABLE_RTTI_AND_EXCEPTIONS=ON -DBUILD_SHARED_LIBS=OFF -DFREETYPE_INCLUDE_DIR_freetype2=${FREETYPE}/include -DFREETYPE_INCLUDE_DIR_ft2build=${FREETYPE}/include -DFREETYPE_LIBRARY_DEBUG=${FREETYPE}/${OS}/${DEBUG_DIR}/freetype.lib -DFREETYPE_LIBRARY_RELEASE=${FREETYPE}/${OS}/${RELEASE_DIR}/freetype.lib ${RMLUI})
##WIN32_BASH("#!/bin/bash\;
##cd /${RMLUI}/${OS}\;
##export PATH=/c/mingw32/bin:$PATH\;
##export PATH=/c/msys/bin:$PATH\;
##make\;
##exit\;")


MAC_DKQCOMMAND(${DKCMAKE_BUILD} -DENABLE_PRECOMPILED_HEADERS=OFF ${FREETYPE_CMAKE} ${RMLUI})
MAC_XCODE(${RMLUI_NAME} RmlCore)
MAC_XCODE(${RMLUI_NAME} RmlDebugger)

IOS_DKQCOMMAND(${DKCMAKE_BUILD} -DBUILD_SHARED_LIBS=OFF -DENABLE_PRECOMPILED_HEADERS=OFF ${FREETYPE_CMAKE} ${RMLUI})
IOS_XCODE(${RMLUI_NAME} RmlCore)
IOS_XCODE(${RMLUI_NAME} RmlDebugger)

IOSSIM_DKQCOMMAND(${DKCMAKE_BUILD} -DBUILD_SHARED_LIBS=OFF -DENABLE_PRECOMPILED_HEADERS=OFF ${FREETYPE_CMAKE} ${RMLUI})
IOSSIM_XCODE(${RMLUI_NAME} RmlCore)
IOSSIM_XCODE(${RMLUI_NAME} RmlDebugger)

LINUX_DKQCOMMAND(${DKCMAKE_BUILD} ${FREETYPE_CMAKE} ${RMLUI})
LINUX_DKQCOMMAND(make RmlCore)
LINUX_DKQCOMMAND(make RmlDebugger)

RASPBERRY_DKQCOMMAND(${DKCMAKE_BUILD} ${FREETYPE_CMAKE} ${RMLUI})
RASPBERRY_DKQCOMMAND(make RmlCore)
RASPBERRY_DKQCOMMAND(make RmlDebugger)

ANDROID_DKQCOMMAND(${DKCMAKE_BUILD} "-DCMAKE_CXX_FLAGS=-DRMLUI_STATIC_LIB -DCHOBO_FLAT_MAP_NO_THROW -DRMLUI_USE_CUSTOM_RTTI -std=c++1z" -DENABLE_PRECOMPILED_HEADERS=OFF -DDISABLE_RTTI_AND_EXCEPTIONS=ON ${FREETYPE_CMAKE} ${RMLUI})
ANDROID_VS(${RMLUI_NAME} RmlUi.sln RmlCore)
ANDROID_VS(${RMLUI_NAME} RmlUi.sln RmlDebugger)
