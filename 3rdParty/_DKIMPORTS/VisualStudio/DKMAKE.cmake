if(NOT CMAKE_HOST_WIN32)
	return()
endif()

if(ANDROID)
	DKDEPEND(android-ndk)
endif()
 
### VERSION ###
DKSET(VISUALSTUDIO_VERSION 2019)
DKSET(VC_EXE "C:/Program Files (x86)/Microsoft Visual Studio/${VISUALSTUDIO_VERSION}/Community/MSBuild/Current/Bin/MSBuild.exe")
DKSET(GENERATOR "Visual Studio 16 ${VISUALSTUDIO_VERSION}")

DKSET(DKCMAKE_WIN32 ${CMAKE_COMMAND} -G ${GENERATOR} -A Win32 -DBUILD_SHARED_LIBS=OFF "-DCMAKE_C_FLAGS=/DWIN32 /D_WINDOWS /W3 /nologo" "-DCMAKE_C_FLAGS_DEBUG=/MTd /Od /Ob0 /Zi /RTC1 /DDEBUG /D_DEBUG" "-DCMAKE_C_FLAGS_RELEASE=/MT /O2 /Ob2 /DNDEBUG" "-DCMAKE_CXX_FLAGS=/DWIN32 /D_WINDOWS /W3 /nologo" "-DCMAKE_CXX_FLAGS_DEBUG=/MTd /Od /Ob0 /Zi /RTC1 /DDEBUG /D_DEBUG" "-DCMAKE_CXX_FLAGS_RELEASE=/MT /O2 /Ob2 /DNDEBUG")

DKSET(DKCMAKE_WIN64 ${CMAKE_COMMAND} -G ${GENERATOR} -A x64 -DBUILD_SHARED_LIBS=OFF "-DCMAKE_C_FLAGS=/DWIN64 /D_WINDOWS /W3 /nologo" "-DCMAKE_C_FLAGS_DEBUG=/MTd /Od /Ob0 /Zi /RTC1 /DDEBUG /D_DEBUG" "-DCMAKE_C_FLAGS_RELEASE=/MT /O2 /Ob2 /DNDEBUG" "-DCMAKE_CXX_FLAGS=/DWIN64 /D_WINDOWS /W3 /nologo" "-DCMAKE_CXX_FLAGS_DEBUG=/MTd /Od /Ob0 /Zi /RTC1 /DDEBUG /D_DEBUG" "-DCMAKE_CXX_FLAGS_RELEASE=/MT /O2 /Ob2 /DNDEBUG")

DKSET(DKCMAKE_ANDROID32 ${CMAKE_COMMAND} -G ${GENERATOR} -A ARM -DCMAKE_ANDROID_NDK=${ANDROID_NDK} -DANDROID_ABI=armeabi-v7a -DANDROID_ARM_NEON=TRUE -DANDROID_PLATFORM=26 -DCMAKE_ANDROID_STL=c++_static "-DANDROID_CPP_FEATURES=rtti exceptions" -DBUILD_SHARED_LIBS=OFF "-DCMAKE_C_FLAGS=-DANDROID -D_ANDROID32" "-DCMAKE_C_FLAGS_DEBUG=-g2 -gdwarf-2 -O0 -DDEBUG -D_DEBUG" "-DCMAKE_C_FLAGS_RELEASE=-DNDEBUG" "-DCMAKE_CXX_FLAGS=-DANDROID -D_ANDROID32" "-DCMAKE_CXX_FLAGS_DEBUG=-g2 -gdwarf-2 -O0 -DDEBUG -D_DEBUG" "-DCMAKE_CXX_FLAGS_RELEASE=-DNDEBUG" -DCMAKE_TOOLCHAIN_FILE=${ANDROID_NDK}/build/cmake/android.toolchain.cmake)

DKSET(DKCMAKE_ANDROID64 ${CMAKE_COMMAND} -G ${GENERATOR} -A ARM64 -DCMAKE_ANDROID_NDK=${ANDROID_NDK} -DCMAKE_TOOLCHAIN_FILE=${ANDROID_NDK}/build/cmake/android.toolchain.cmake -DANDROID_ABI=arm64-v8a -DANDROID_PLATFORM=26 -DCMAKE_ANDROID_STL=c++_static -DBUILD_SHARED_LIBS=OFF "-DCMAKE_C_FLAGS=/DANDROID /D_ANDROID64" "-DCMAKE_C_FLAGS_DEBUG=/DDEBUG /D_DEBUG" "-DCMAKE_C_FLAGS_RELEASE=/DNDEBUG")


### INSTALL ###
IF(NOT EXISTS "C:/Program Files (x86)/Microsoft Visual Studio/${VISUALSTUDIO_VERSION}/Community")
	MESSAGE(STATUS "Installing Visual Studio ${VISUALSTUDIO_VERSION}")
	DKSETPATH(${DIGITALKNOB}/Download)
	## https://download.visualstudio.microsoft.com/download/pr/5e397ebe-38b2-4e18-a187-ac313d07332a/169156e6e9a005d49b357c42240184dc1e3ccc28ebc777e70d49257c074f77e8/vs_Community.exe
	DKDOWNLOAD(https://download.visualstudio.microsoft.com/download/pr/5e397ebe-38b2-4e18-a187-ac313d07332a/169156e6e9a005d49b357c42240184dc1e3ccc28ebc777e70d49257c074f77e8/vs_Community.exe)
	DKSET(QUEUE_BUILD ON)
	WIN_COMMAND(${DIGITALKNOB}/Download/vs_Community.exe)
ENDIF()
